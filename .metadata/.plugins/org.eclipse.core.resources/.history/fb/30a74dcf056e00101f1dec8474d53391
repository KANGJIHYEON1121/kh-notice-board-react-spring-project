package com.kh.notice_board.util;

import lombok.extern.log4j.Log4j2;

@Log4j2
public class JWTUtil {
	// 최소 256비트(32바이트) 이상이어야됨, HMAC-SHA 알고리즘용 사용되는 키값
	private static String key = "1234567890123456789012345678901234567890";

	// 사용자 정보(Map)를 받아서 JWT 토큰을 생성
	public static String generateToken(Map<String, Object> valueMap, int min) {
		SecretKey key = null;
		try {
			// 문자열 비밀 키를 SecretKey 객체로 변환 (HMAC-SHA 알고리즘 사용)
			key = Keys.hmacShaKeyFor(JWTUtil.key.getBytes("UTF-8"));
		} catch (Exception e) {
			throw new RuntimeException(e.getMessage());
		}
		// JWT 토큰 문자열을 생성
		String jwtStr = Jwts.builder().setHeader(Map.of("typ", "JWT")) // JWT 헤더 지정
				.setClaims(valueMap) // 사용자 정보(Claims) 설정
				.setIssuedAt(Date.from(ZonedDateTime.now().toInstant())) // 발행 시각
				.setExpiration(Date.from(ZonedDateTime.now().plusMinutes(min).toInstant())) // 만료 시각
				.signWith(key) // 서명
				.compact(); // 최종 JWT 문자열 생성
		return jwtStr; // JWT 토큰 문자열 :"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
	}
}
